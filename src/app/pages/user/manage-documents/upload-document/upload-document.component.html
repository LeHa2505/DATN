<div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="24">
        <form nz-form class="formAgreement">

            <nz-card nzTitle="Document upload" style="margin-bottom: 16px;" id="documentPart" [nzExtra]="extraTemplate">
                <div style="padding: 0 24px;">
                    <!-- <nz-divider nzText="Document required" [nzPlain]="false" nzOrientation="left"></nz-divider> -->
                    <div nz-row>
                        <nz-form-label nzRequired nzFor="additionalInformation" nz-col [nzSpan]="4">
                            <strong>Select type of document</strong>
                        </nz-form-label>
                        <nz-tree-select style="width: 250px" [nzExpandedKeys]="expandKeys" [nzNodes]="nodes"
                            nzShowSearch nzPlaceHolder="Please select" [(ngModel)]="typeDocSelect"
                            (ngModelChange)="onChange($event)"></nz-tree-select>
                        <button nz-button class="file-input" (click)="file.click()" style="margin-left: 1rem;">
                            <span nz-icon nzType="upload"></span>
                            Click to Upload File
                        </button>
                        <input style="display: none;" type="file" class="file-input" (change)="onFileSelected($event)"
                            #file>
                        <!-- <button nz-button nzType="primary" style="margin-left: 1rem;"
                            (click)="uploadConfirm()">Upload</button> -->
                        <!-- <nz-form-item class="document-style" nz-row [nzGutter]="24"> -->
                        <!-- <nz-form-label nzRequired nzFor="additionalInformation" nz-col [nzSpan]="4">
                                <strong>Bill of exchange</strong>
                            </nz-form-label> -->
                        <!-- <div>
                                <div *ngIf="isFinish == false">
                                    <button nz-button class="file-input" (click)="fileUploadBillOfExchange.click()">
                                        <span nz-icon nzType="upload"></span>
                                        Click to Upload File
                                    </button>
                                    <nz-upload [nzFileList]="bill_of_exchange_list"></nz-upload> -->
                        <!-- <input style="display: none;" type="file" class="file-input"
                                        (change)="onFileSelectedBillOfExchange($event)" #fileUploadBillOfExchange>
                                </div>
                                <div class="file-upload" style="color: #1890ff;">
                                    <div *ngIf="bill_of_exchange.name">
                                        <a style="color: #1890ff" href="{{bill_of_exchange.url}}"
                                            target="_blank"><span nz-icon nzType="paper-clip" nzTheme="outline"></span>
                                            {{bill_of_exchange.name}}</a>
                                    </div>
                                    <span *ngIf="!bill_of_exchange.name" style="color: #555;">
                                        No file uploaded yet.</span>
                                </div>
                            </div> -->
                        <!-- </nz-form-item>  -->

                    </div>

                    <div nz-row>
                        <nz-form-label nzRequired nzFor="additionalInformation" nz-col [nzSpan]="4">
                            <strong>Document uploaded</strong>
                        </nz-form-label>
                        <nz-form-control>
                            <a *ngIf="path_file" target="_blank" [href]="path_file">{{path_file}}</a>
                            <span *ngIf="!path_file">No file uploaded</span>
                        </nz-form-control>
                    </div>

                    <!-- <nz-divider></nz-divider> -->

                    <!-- <div>
                        <nz-form-item class="document-style" nz-row [nzGutter]="24">
                            <nz-form-label nzRequired nzFor="additionalInformation" nz-col [nzSpan]="4">
                                <strong>Bill of lading</strong>
                            </nz-form-label>
                            <div>
                                <div *ngIf="isFinish == false">
                                    <button nz-button class="file-input" (click)="fileUploadBillOfLading.click()">
                                        <span nz-icon nzType="upload"></span>
                                        Click to Upload File
                                    </button>
                                    <input style="display: none;" type="file" class="file-input"
                                        (change)="onFileSelectedBillOfLading($event)" #fileUploadBillOfLading>
                                </div>
                                <div class="file-upload" style="color: #1890ff;">
                                    <div *ngIf="bill_of_lading.name">
                                        <a style="color: #1890ff" href="{{bill_of_lading.url}}"
                                        target="_blank"><span nz-icon nzType="paper-clip" nzTheme="outline"></span>
                                        {{bill_of_lading.name}}</a>
                                    </div>
                                    <span *ngIf="!bill_of_lading.name" style="color: #555;">No file uploaded yet.</span>
                                </div>
                            </div>
                        </nz-form-item>
                    </div>

                    <nz-divider></nz-divider>

                    <div>
                        <nz-form-item class="document-style" nz-row [nzGutter]="24">
                            <nz-form-label nzRequired nzFor="additionalInformation" nz-col [nzSpan]="4">
                                <strong>Invoice</strong>
                            </nz-form-label>
                            <div>
                                <div *ngIf="isFinish == false">
                                    <button nz-button class="file-input" (click)="fileUploadInvoice.click()">
                                        <span nz-icon nzType="upload"></span>
                                        Click to Upload File
                                    </button>
                                    <input style="display: none;" type="file" class="file-input"
                                        (change)="onFileSelectedInvoice($event)" #fileUploadInvoice>
                                </div>
                                <div class="file-upload" style="color: #1890ff;">
                                    <div *ngIf="invoice.name">
                                        <a style="color: #1890ff" href="{{invoice.url}}"
                                        target="_blank"><span nz-icon nzType="paper-clip" nzTheme="outline"></span>
                                        {{invoice.name}}</a>
                                        
                                    </div>
                                    <span *ngIf="!invoice.name" style="color: #555;">No file uploaded yet.</span>
                                </div>
                            </div>
                        </nz-form-item>
                    </div> -->

                </div>

                <!-- <nz-divider></nz-divider> -->

                <!-- <div class="button-group" *ngIf="isFinish == false">
                    <nz-form-item>
                        <nz-form-control>
                            <button nz-button nzType="primary" (click)="uploadConfirm()">Upload</button>
                        </nz-form-control>
                    </nz-form-item>
                </div> -->
            </nz-card>
        </form>
    </div>
</div>
<div nz-row>
    <nz-card nz-col [nzSpan]="24" *ngIf="isDisplay" style="width: 100%; margin-top: 16px" [nzLoading]="!ocrDocument"
        nzTitle="Content" [nzExtra]="extraTemplate2">
        <form nz-form [formGroup]="invoiceForm" (ngSubmit)="onSubmit()" [nzLayout]="'horizontal'">
            <nz-form-item *ngFor="let control of formControls">
                <nz-form-label style="text-align: left;" [nzSpan]="6" nz-for="{{ control.name }}">
                    <strong>
                        {{ control.label }}
                    </strong>
                </nz-form-label>
                <nz-form-control [nzSpan]="18">
                    <input *ngIf="isEditable" nz-input [formControl]="invoiceForm.get(control.name)" />
                    <div *ngIf="!isEditable">{{ invoiceForm.get(control.name).value }}</div>
                </nz-form-control>
            </nz-form-item>
        </form>
        <form *ngIf="invoiceTableForm" nz-form [formGroup]="invoiceTableForm" (ngSubmit)="onSubmit()">
            <nz-form-item>
                <nz-form-control>
                    <nz-table [nzNoResult]="' '">
                        <thead>
                            <!-- <tr>
                      <th *ngFor="let header of tableHeaders">{{ header }}</th>
                    </tr> -->
                        </thead>
                        <tbody>
                            <tr *ngFor="let data of tableData; let i = index" [formGroup]="getRowFormGroup(i)">
                                <td *ngFor="let row of tableHeaders; let j = index">
                                    <div *ngIf="isEditable">
                                        <div class="editable-cell"
                                            [hidden]="!(editingCell && editingCell.rowIndex === i && editingCell.columnName === row)"
                                            (blur)="stopEdit()">
                                            <input style="width: fit-content;" nz-input
                                                [formControl]="getCellControl(i, row)" />
                                        </div>
                                        <div [hidden]="!!(editingCell && editingCell.rowIndex === i && editingCell.columnName === row)"
                                            (click)="startEdit(i, row)">
                                            {{ data[row] }}
                                        </div>
                                    </div>

                                    <div *ngIf="!isEditable">
                                        {{ data[row] }}
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </nz-table>
                </nz-form-control>
            </nz-form-item>
        </form>
        <nz-form-item>
            <nz-form-control>
                <button nz-button nzType="primary" (click)="onSubmit()" type="submit">Confirm to save</button>
            </nz-form-control>
        </nz-form-item>
        <ng-template #extraTemplate2>
            <button nz-button nzType="primary" (click)="requestEdit()">Edit information</button>
        </ng-template>
    </nz-card>
</div>

<ng-template #extraTemplate>
    <div style="color: #f81d22;">
        <nz-badge nzDot><span style="color: #f81d22;" nz-icon nzType="notification"></span></nz-badge>
        <span> Only accept PDF file</span>
    </div>
</ng-template>